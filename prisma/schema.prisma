// Prisma schema for ShotaProjectWeb (MariaDB / MySQL)
// Run: `npx prisma generate` then `npx prisma migrate dev --name init` (or `prisma migrate deploy` in production)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       String  @id @db.VarChar(64)
  username String  @unique @db.VarChar(191)
  password String  @db.VarChar(255)
  chats    Chat[]
  @@map("users")
}

model Chat {
  id        String    @id @db.VarChar(64)
  userId    String    @db.VarChar(64)
  title     String?   @db.VarChar(255)
  createdAt DateTime  @db.DateTime(6)
  messages  Message[]

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@map("chats")
}

model Message {
  id        Int      @id @default(autoincrement())
  chatId    String   @db.VarChar(64)
  role      String   @db.VarChar(20)
  content   String   @db.LongText
  timestamp DateTime @db.DateTime(6)

  chat Chat @relation(fields: [chatId], references: [id], onDelete: Cascade)
  @@map("messages")
}
